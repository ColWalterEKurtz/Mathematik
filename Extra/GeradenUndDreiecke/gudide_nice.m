clear all;

rindex = 0;

rindex += 1;
P = [7 2];
Q = [1 -6];
R = [-15 -16];
S = [15 8];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [1 -2];
Q = [18 2];
R = [5 -9];
S = [15 -7];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [19 18];
Q = [-16 -3];
R = [10 2];
S = [-5 -4];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [4 14];
Q = [9 -16];
R = [12 7];
S = [8 3];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [3 2];
Q = [-8 20];
R = [13 -3];
S = [-20 1];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [2 13];
Q = [3 9];
R = [12 -9];
S = [-14 11];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [18 -8];
Q = [-2 -18];
R = [10 11];
S = [19 14];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [7 13];
Q = [-9 -19];
R = [-2 -16];
S = [-8 -13];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-19 8];
Q = [-15 16];
R = [-3 -5];
S = [9 15];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [15 14];
Q = [-8 -13];
R = [6 19];
S = [3 10];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [18 19];
Q = [13 14];
R = [7 3];
S = [-10 -2];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-16 13];
Q = [12 -1];
R = [4 15];
S = [-2 5];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [18 -16];
Q = [16 -10];
R = [-17 -8];
S = [-18 -11];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [17 3];
Q = [12 13];
R = [-13 -6];
S = [-14 -5];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-6 7];
Q = [13 -14];
R = [-13 -2];
S = [4 -19];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [19 5];
Q = [-17 -4];
R = [-1 10];
S = [3 -11];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-19 -12];
Q = [-13 -2];
R = [-15 3];
S = [-18 1];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-4 6];
Q = [2 -14];
R = [-5 20];
S = [-1 -12];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [-7 -10];
Q = [9 4];
R = [15 -1];
S = [1 -3];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [4 -6];
Q = [16 -15];
R = [7 -18];
S = [13 18];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

rindex += 1;
P = [13 -7];
Q = [15 1];
R = [2 4];
S = [6 -20];
PQRS(rindex, 1) = P(1);
PQRS(rindex, 2) = P(2);
PQRS(rindex, 3) = Q(1);
PQRS(rindex, 4) = Q(2);
PQRS(rindex, 5) = R(1);
PQRS(rindex, 6) = R(2);
PQRS(rindex, 7) = S(1);
PQRS(rindex, 8) = S(2);

% LaTeX-Dokument
DOC = fopen("gudide.tex", "w");
fprintf(DOC, "\\documentclass\n");
fprintf(DOC, "[\n");
fprintf(DOC, "  draft    = true,\n");
fprintf(DOC, "  fontsize = 11pt,\n");
fprintf(DOC, "  parskip  = half-,\n");
fprintf(DOC, "  BCOR     = 0pt,\n");
fprintf(DOC, "  DIV      = 11,\n");
fprintf(DOC, "  ngerman\n");
fprintf(DOC, "]\n");
fprintf(DOC, "{scrartcl}\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% default packages\n");
fprintf(DOC, "\\usepackage[utf8]{inputenc}\n");
fprintf(DOC, "\\usepackage[T1]{fontenc}\n");
fprintf(DOC, "\\usepackage{lmodern}\n");
fprintf(DOC, "\\usepackage[ngerman]{babel}\n");
fprintf(DOC, "%% extra packages\n");
fprintf(DOC, "\\usepackage{amsmath}\n");
fprintf(DOC, "\\usepackage{enumerate}\n");
fprintf(DOC, "\\usepackage{siunitx}\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% ------------------------------------------------------------------------------\n");
fprintf(DOC, "\\begin{document}\n");
fprintf(DOC, "%% ------------------------------------------------------------------------------\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% ------------------------------------------\n");
fprintf(DOC, "\\section*{Geraden und Dreiecke in der Ebene}\n");
fprintf(DOC, "%% ------------------------------------------\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% -------------------\n");
fprintf(DOC, "\\paragraph{Aufgabe 1}\n");
fprintf(DOC, "%% -------------------\n");
fprintf(DOC, "In welchem Punkt schneidet die Gerade $g_1$, die durch die Punkte $P$\n");
fprintf(DOC, "und $Q$ festgelegt ist, die Gerade $g_2$, die durch die Punkte $R$ und\n");
fprintf(DOC, "$S$ verfäuft?\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% -------------------\n");
fprintf(DOC, "\\paragraph{Aufgabe 2}\n");
fprintf(DOC, "%% -------------------\n");
fprintf(DOC, "Nimmt man die $x$-Achse als dritte Gerade hinzu, ergibt sich zusammen\n");
fprintf(DOC, "mit den Geraden $g_1$ und $g_2$ ein Dreieck.\n");
fprintf(DOC, "\\begin{enumerate}[{2}.1]\n");
fprintf(DOC, "  \\item Bestimme den Umfang dieses Dreiecks.\n");
fprintf(DOC, "  \\item Bestimme den Flächeninhalt dieses Dreiecks.\n");
fprintf(DOC, "  \\item Bestimme die Innenwinkel dieses Dreiecks.\n");
fprintf(DOC, "\\end{enumerate}\n");
fprintf(DOC, "\n");
fprintf(DOC, "\\hrulefill\n");
fprintf(DOC, "\n");
fprintf(DOC, "\\input{gudide_ex}\n");
fprintf(DOC, "\n");
fprintf(DOC, "\\clearpage\n");
fprintf(DOC, "\n");
fprintf(DOC, "\\input{gudide_sl}\n");
fprintf(DOC, "\n");
fprintf(DOC, "%% ------------------------------------------------------------------------------\n");
fprintf(DOC, "\\end{document}\n");
fprintf(DOC, "%% ------------------------------------------------------------------------------\n");
fclose(DOC);

FEX = fopen("gudide_ex.tex", "w");
FSL = fopen("gudide_sl.tex", "w");
LOG = fopen("gudide_pt.log", "w");

fprintf(FEX, "\\begin{equation*}\n");
fprintf(FEX, "  \\begin{array}{lllll}\n");

exnum = 1;
exmax = size(PQRS, 1);

while (exnum <= exmax)

  P = [PQRS(exnum, 1) PQRS(exnum, 2)];
  Q = [PQRS(exnum, 3) PQRS(exnum, 4)];
  R = [PQRS(exnum, 5) PQRS(exnum, 6)];
  S = [PQRS(exnum, 7) PQRS(exnum, 8)];

  [valid m1 b1 m2 b2 z1 z2 cx cy u f alpha beta gamma] = gudide_calc(P, Q, R, S);

  % kein Schnittpunkt
  if (!valid)

    continue

  endif

  fprintf(LOG, "%% %s\n", (96 + exnum));
  fprintf(LOG, "P = [%g %g];\n", P(1), P(2));
  fprintf(LOG, "Q = [%g %g];\n", Q(1), Q(2));
  fprintf(LOG, "R = [%g %g];\n", R(1), R(2));
  fprintf(LOG, "S = [%g %g];\n", S(1), S(2));
  fprintf(LOG, "\n");

  % Ecken des Dreiecks
  C = [cx cy];
  A = [z1 0];
  B = [z2 0];

  ins_P = sprintf("P\\left(%s\\;\\middle|\\;%s\\right)", texnum(P(1)), texnum(P(2)));
  ins_Q = sprintf("Q\\left(%s\\;\\middle|\\;%s\\right)", texnum(Q(1)), texnum(Q(2)));
  ins_R = sprintf("R\\left(%s\\;\\middle|\\;%s\\right)", texnum(R(1)), texnum(R(2)));
  ins_S = sprintf("S\\left(%s\\;\\middle|\\;%s\\right)", texnum(S(1)), texnum(S(2)));
  ins_A = sprintf("A\\left(%s\\;\\middle|\\;%s\\right)", texnum(A(1)), texnum(A(2)));
  ins_B = sprintf("B\\left(%s\\;\\middle|\\;%s\\right)", texnum(B(1)), texnum(B(2)));
  ins_C = sprintf("C\\left(%s\\;\\middle|\\;%s\\right)", texnum(C(1)), texnum(C(2)));
  ins_u = texnum(u);
  ins_f = texnum(f);
  ins_alpha = texnum(alpha);
  ins_beta  = texnum(beta);
  ins_gamma = texnum(gamma);

  if ((exnum + 1) <= exmax)

    fprintf(FEX, "    \\text{%s)} & %s & %s & %s & %s \\\\[1ex]\n", (96 + exnum), ins_P, ins_Q, ins_R, ins_S);

  else

    fprintf(FEX, "    \\text{%s)} & %s & %s & %s & %s\n", (96 + exnum), ins_P, ins_Q, ins_R, ins_S);

  endif

  fprintf(FSL, "\\paragraph{Lösung %s)}\n", (96 + exnum));
  fprintf(FSL, "\\begin{equation*}\n");
  fprintf(FSL, "  g_1:f(x)=%s\n", polystr([m1, b1]));
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  g_2:f(x)=%s\n", polystr([m2, b2]));
  fprintf(FSL, "\\end{equation*}\n");
  fprintf(FSL, "\n");
  fprintf(FSL, "\\begin{equation*}\n");
  fprintf(FSL, "  %s\n", ins_A);
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  %s\n", ins_B);
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  %s\n", ins_C);
  fprintf(FSL, "\\end{equation*}\n");
  fprintf(FSL, "\n");
  fprintf(FSL, "\\begin{equation*}\n");
  fprintf(FSL, "  U_D=%s\n", ins_u);
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  A_D=%s\n", ins_f);
  fprintf(FSL, "\\end{equation*}\n");
  fprintf(FSL, "\n");
  fprintf(FSL, "\\begin{equation*}\n");
  fprintf(FSL, "  \\alpha=%s\n", ins_alpha);
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  \\beta=%s\n", ins_beta);
  fprintf(FSL, "  \\qquad\n");
  fprintf(FSL, "  \\gamma=%s\n", ins_gamma);
  fprintf(FSL, "\\end{equation*}\n");
  fprintf(FSL, "\n");

  exnum += 1;

endwhile

fprintf(FEX, "  \\end{array}\n");
fprintf(FEX, "\\end{equation*}\n");

fclose(FEX);
fclose(FSL);
fclose(LOG);

